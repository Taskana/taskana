<!-- WORKBASKET FILTER -->
<div *ngIf="filterTypeIsWorkbasket(); else taskType">

  <!-- COLLAPSED WORKBASKET FILTER -->
  <div class="filter__collapsed-filter" *ngIf="!isExpanded">
    <!-- TEXT INPUT -->
      <mat-form-field appearance="legacy" floatLabel="auto" class="collapsed-filter_input-field">
        <mat-label>Filter by name</mat-label>
        <input matInput [(ngModel)]="filter.filterParams.name" matTooltip="Type to filter by name" (keyup.enter)="search()">
      </mat-form-field>

      <!-- CLEAR BUTTON -->
      <button mat-stroked-button (click)="clear(); search()" matTooltip="Clear workbasket filter" class="filter__undo-button">
        <mat-icon style="color: #555">undo</mat-icon>
      </button>

      <!-- SEARCH BUTTON -->
      <button mat-stroked-button (click)="search()" matTooltip="Search by given filter" class="filter__search-button">
        <mat-icon>search</mat-icon>
      </button>
  </div>


  <!-- EXPANDED WORKBASKET FILTER -->
  <div class="filter" *ngIf="isExpanded">

    <!-- TEXT INPUT -->
    <div class="filter__text-input">
      <div class="filter__name-and-key-input">
      <mat-form-field appearance="legacy" floatLabel="auto" class="filter__input-field">
        <mat-label>Filter by name</mat-label>
        <input matInput [(ngModel)]="filter.filterParams.name" matTooltip="Type to filter by name" (keyup.enter)="search()">
      </mat-form-field>

      <mat-form-field appearance="legacy" floatLabel="auto" class="filter__input-field">
        <mat-label>Filter by key</mat-label>
        <input matInput [(ngModel)]="filter.filterParams.key" matTooltip="Type to filter by key" (keyup.enter)="search()">
      </mat-form-field>
      </div>

      <div class="filter__name-and-key-input">
        <mat-form-field appearance="legacy" floatLabel="auto" class="filter__input-field">
          <mat-label>Filter by description</mat-label>
          <input matInput [(ngModel)]="filter.filterParams.description" matTooltip="Type to filter by description" (keyup.enter)="search()">
        </mat-form-field>

        <mat-form-field appearance="legacy" floatLabel="auto" class="filter__input-field">
          <mat-label>Filter by owner</mat-label>
          <input matInput [(ngModel)]="filter.filterParams.owner" matTooltip="Type to filter by owner" (keyup.enter)="search()">
        </mat-form-field>
      </div>
    </div>


    <!-- SEARCH AND CLEAR BUTTON -->
    <div class="filter__action-buttons">

      <!-- TYPE FILTER -->
      <button mat-stroked-button [matMenuTriggerFor]="menu" matTooltip="Filter workbaskets by type">
        Filter by type
        <mat-icon *ngIf="filter.filterParams?.type == ''" style="color: #555">filter_list</mat-icon>
        <taskana-administration-icon-type *ngIf="filter.filterParams?.type != ''" [type]="filter.filterParams?.type"> </taskana-administration-icon-type>
      </button>

      <mat-menu #menu="matMenu">
        <button mat-menu-item *ngFor="let type of allTypes | mapValues" (click)="selectType(type.key); search()">
          <taskana-administration-icon-type [type]='type.key' [text]="type.value"></taskana-administration-icon-type>
        </button>
      </mat-menu>

      <!-- CLEAR BUTTON -->
      <button mat-stroked-button (click)="clear(); search()" matTooltip="Clear workbasket filter">
        Reset
        <mat-icon style="color: #555">undo</mat-icon>
      </button>

      <!-- SEARCH BUTTON -->
      <button mat-stroked-button (click)="search()" matTooltip="Search by given filter" class="filter__search-button">
        Apply
        <mat-icon>search</mat-icon>
      </button>
    </div>
  </div>
</div>


<!-- TASK FILTER -->
<ng-template #taskType>
  <div class="row">
    <div class="col-xs-2">
      <taskana-shared-number-picker [(ngModel)]="filter.filterParams.priority" (keyup.enter)="search()" title="priority" id="display-priority-filter"></taskana-shared-number-picker>
    </div>
    <div class="col-xs-4">
      <input type="text" [(ngModel)]="filter.filterParams.name" (keyup.enter)="search()" class="form-control" id="display-name-filter"
        placeholder="Filter name">
    </div>
    <div class="col-xs-4">
      <input type="text" [(ngModel)]="filter.filterParams.owner" (keyup.enter)="search()" class="form-control" id="display-owner-filter"
        placeholder="Filter owner">
    </div>
    <button (click)="clear(); search()" class="btn btn-default pull-right margin-right" type="button" data-toggle="tooltip"
      title="Clear">
      <span class="material-icons md-20 blue">clear</span>
    </button>
  </div>
  <div class="row">
    <div class="dropdown col-xs-2 col-xs-offset-2">
      <button class="btn btn-default" data-toggle="dropdown" type="button" data-toggle="dropdown" aria-haspopup="true"
        aria-expanded="true" title="State: {{filter.filterParams.state ? filter.filterParams?.state : 'All'}}">
        <span>{{filter.filterParams.state ? filter.filterParams?.state : 'All'}}</span>
      </button>
      <ul class="dropdown-menu dropdown-menu-users" role="menu">
        <li>
          <a *ngFor="let state of allStates | mapValues" type="button" (click)="selectState(state.key); search()"
            data-toggle="tooltip" [title]="state.value">
            <label class="blue">{{state.value}}</label>
          </a>
        </li>
      </ul>
    </div>
    <button (click)="search()" type="button" class="btn btn-default pull-right margin-right" data-toggle="tooltip"
      title="Search">
      <span class="material-icons md-20 blue">search</span>
    </button>
  </div>
</ng-template>

